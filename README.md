# Фильтр желтушных новостей

Сервис позволяет рассчитать показатель "желтизны" статьи из СМИ по ссылке на нее. Чем больше в статье слов, которые аппелируют не к разуму, а к негативным и позитивным эмоциям и чувствам читателя, тем более статья "желтая". Этот показатель "желтизны" рассчитывается на основе специальных словарей негативно и позитивно окрашенных слов.

Пока поддерживается только один новостной сайт - [ИНОСМИ.РУ](https://inosmi.ru/). Для него разработан специальный адаптер, умеющий выделять текст статьи на фоне остальной HTML разметки. Для других новостных сайтов потребуются новые адаптеры, все они будут находиться в каталоге `adapters`. Туда же помещен код для сайта ИНОСМИ.PY: `adapters/inosmi_ru.py`.

В перспективе можно создать универсальный адаптер, подходящий для всех сайтов, но его разработка будет сложной и потребует дополнительных времени и сил.


### Предпочительнее установить на ОС LINUX с помощью Docker и docker-compose

Установка будет развернута из контейнеров с доступом через "обратный прокси" [Nginx](https://nginx.org/ru/) для ограничения количества запросов в минуту с одного ip и кеширования для ускорения работы по известным запросам c помощью [Redis](https://redis.io/).
Скачиваем файлы.
Переходим в папку с файлами.

```
make build
```
режим "демона" -

```
make run
```
режим вывода логов -

```
make run_logs
```

### Как установить без Docker

Скачиваем файлы. 

Python>=3.8.0 должен быть уже установлен. Для установки зависимостей рекомендуется создать виртуальное окружение. 
Затем используйте pip для установки зависимостей:

```
pip install -r requirements.txt
```

### Использование

Переходим в каталог с программой
Команда -

```
python main.py
```

Можно также запускать с аргументами, кроме текста сообщения аргументы имеют параметры по умолчанию.

**usage: main.py [-h] [-host HOST] [-port PORT] [-redis_host REDIS_HOST] [-redis_port REDIS_PORT] [-use_cache]**


`optional arguments:`


`-h, --help            show this help message and exit`

`-host HOST`

`-port PORT`

`-redis_host REDIS_HOST`

`-redis_port REDIS_PORT`

`-use_cache            Redis cache ON/OFF checker (default: False)`

Сервис будет запущен по этому веб-адресу -

###### *http://{ваш_localhost}:80*

и будет принимать запросы вида:

###### *http://{ваш_localhost}?urls=url_статьи*

###### *http://{ваш_localhost}?urls=url_статьи1,url_статьи2*

Максимум 10 url статей.

Браузер будет отдавать результ в формате JSON.

Пример -

![](https://i.ibb.co/4WYKQS8/image.png)

# Как запустить тесты

Для тестирования используется [pytest](https://docs.pytest.org/en/latest/), тесты созданы для основного функционала и фрагментов кода сложного в отладке: text_tools.py и адаптеры. 

**Запуск тестов -**
```
python -m pytest
python -m pytest -m adapters_inosmi_ru
python -m pytest -m text_tools
python -m pytest -m server
```

Docker
```
make test
make test_adapters
make test_tools
make test_server
```

# Цели проекта

Код написан в учебных целях. Это урок из курса по веб-разработке — [Девман](https://dvmn.org).
